<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Game <%= id %> — Mockup</title>
    <style>
      :root{
        --bg:#f6f7f9;
        --table:#c9f1cb;
        --card:#fff;
        --accent:#2b6cb0;
        --muted:#c9c9c9;
      }
      html,body{height:100%;margin:0;font-family:Inter, system-ui, Arial, sans-serif;background:var(--bg);color:#1f2937}
      .page{display:flex;gap:20px;height:100vh;padding:20px;box-sizing:border-box}
      .table-area{flex:1;position:relative;display:flex;align-items:center;justify-content:center}
      .table-wrapper{width:720px;height:520px;position:relative}
      .poker-table{background:var(--table);border-radius:50%;width:100%;height:100%;box-shadow:0 8px 24px rgba(0,0,0,0.12);position:relative;padding:40px;box-sizing:border-box}
      .pot{position:absolute;top:-100px;left:50%;transform:translateX(-50%);background:#fff;padding:8px 14px;border-radius:10px;border:1px solid #e6e6e6;font-weight:600}
      .community{position:absolute;left:50%;top:42%;transform:translate(-50%,-50%);display:flex;gap:12px}
      .card{width:72px;height:98px;background:var(--card);border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.08);display:flex;align-items:center;justify-content:center;font-weight:700}
      .player-seat{width:70px;height:70px;border-radius:50%;background:#fff;border:2px solid #eee;position:absolute;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 12px rgba(0,0,0,0.06);z-index:6;transition:transform .18s}
      .player-seat .label{font-size:12px;text-align:center}
      .seat.grey{opacity:0.35}
      /* positions for up to 8 seats (outside the table) */
      .seat-pos-1{top:-36px;left:50%;transform:translateX(-50%)}
      .seat-pos-2{top:50px;right:34px}
      .seat-pos-3{top:180px;right:-36px}
      .seat-pos-4{bottom:72px;right:26px}
      .seat-pos-5{bottom:-36px;left:50%;transform:translateX(-50%)}
      .seat-pos-6{bottom:72px;left:26px}
      .seat-pos-7{top:180px;left:-36px}
      .seat-pos-8{top:50px;left:34px}

      /* chips and small indicators */
      .chips{position:absolute;font-size:13px;background:transparent;right:140px;top:110px}
      .chips .stack{display:inline-block;background:#ffd166;padding:6px 8px;border-radius:8px;margin-left:6px;font-weight:700}

      /* player controls area (bottom) */
      .controls{position:absolute;bottom:-120px;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:12px;z-index:5}
      .hole-cards{display:flex;gap:10px}
      .hole-cards .card{width:56px;height:80px}
      .action-btn{padding:10px 16px;border-radius:8px;background:var(--accent);color:#fff;border:none;cursor:pointer}
      .raise-input{width:84px;padding:8px;border-radius:8px;border:1px solid #e6e6e6;text-align:right}
      .action-btn.raise{background:#d97706}

      /* right column - chat and players */
      .side{width:340px;display:flex;flex-direction:column;gap:16px}
      .chat{background:#fff;border-radius:12px;border:1px solid #e6e6e6;padding:12px;display:flex;flex-direction:column;height:420px;box-shadow:0 6px 20px rgba(0,0,0,0.04)}
      .chat .messages{flex:1;overflow:auto;padding:6px}
      .chat .message{padding:8px 10px;border-radius:8px;margin-bottom:8px;background:#f3f4f6}
      .chat .typing{color:#b45309;font-style:italic}
      .chat input{border:1px solid #e6e6e6;padding:10px;border-radius:8px}

      .meta{background:#fff;border-radius:12px;padding:12px;border:1px solid #e6e6e6}

      /* responsiveness */
      @media(max-width:1100px){.page{flex-direction:column}.side{width:100%;height:260px}}
    </style>
  </head>
  <body>
    <div class="page">
      <div class="table-area">
        <div class="table-wrapper">
          <div class="poker-table">
            <div class="pot">Pot: $12.75</div>

            <div class="community">
              <div class="card">A♠</div>
              <div class="card">8♦</div>
              <div class="card">Q♣</div>
            </div>

            <div class="chips" style="left:46%;top:450px;"> <span class="stack">$45</span></div>
            <div class="chips" style="right:80%;top:370px;"> <span class="stack">$35</span></div>
            <div class="chips" style="left:80%;top:140px;"> <span class="stack">$5</span></div>

            <!-- dynamic seats container -->
            <div id="seats"></div>

            <div class="controls">
              <div class="hole-cards">
                <div class="card">A♠</div>
                <div class="card">4♥</div>
              </div>
              <button class="action-btn">Fold</button>
              <button class="action-btn" style="background:#059669">Call</button>
              <div style="display:flex;align-items:center;gap:8px">
                <button class="action-btn raise">Raise</button>
                <input class="raise-input" type="number" min="1" value="5" aria-label="raise amount" />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="side">
        <div class="meta">
          <div style="font-weight:700;margin-bottom:6px">Game</div>
          <div><strong>ID:</strong> <%= id %></div>
          <div><strong>Name:</strong> <%= name %></div>
          <div><strong>Host:</strong> <%= created_by %></div>

          <!-- players demo control (dropdown) -->
          <div style="margin-top:8px;display:flex;align-items:center;gap:8px">
            <label for="playerCountSelect" style="font-weight:600">Players:</label>
            <!-- populate options client-side to avoid literal EJS output in the browser -->
            <select id="playerCountSelect" aria-label="number of players"></select>
            <small style="color:#6b7280">demo only</small>
          </div>

          <div style="margin-top:6px"><a href="/lobby">Return to lobby</a></div>
        </div>

        <div class="chat">
          <div style="font-weight:700;margin-bottom:8px">Chat</div>
          <div class="messages">
            <div class="message">Player 1: Hurry up already</div>
            <div class="message">Player 2: i think they're afk</div>
            <div class="message typing">Player 4 is typing...</div>
          </div>
          <input placeholder="Say something..." />
        </div>
      </div>
    </div>

    <script>
      // populate the player count dropdown client-side (2..8)
      (function populatePlayerSelect(){
        const sel = document.getElementById('playerCountSelect');
        const defaultCount = 7; // change if you want a different initial selection
        for(let i = 2; i <= 8; i++){
          const opt = document.createElement('option');
          opt.value = i;
          opt.textContent = i;
          if(i === defaultCount) opt.selected = true;
          sel.appendChild(opt);
        }
      })();

      // dynamic seat rendering (client-only demo)
      (function(){
        const seatsContainer = document.getElementById('seats');
        const select = document.getElementById('playerCountSelect');

        // positions classes for up to 8 seats (1-indexed)
        const POS_CLASSES = ['seat-pos-1','seat-pos-2','seat-pos-3','seat-pos-4','seat-pos-5','seat-pos-6','seat-pos-7','seat-pos-8'];

        function renderSeats(count){
          seatsContainer.innerHTML = ''; // clear
          // create N seats
          for(let i=1;i<=count;i++){
            const seat = document.createElement('div');
            seat.className = 'player-seat ' + POS_CLASSES[(i-1) % POS_CLASSES.length];
            // add a small label inside
            const inner = document.createElement('div');
            inner.innerHTML = '<div class="label"><strong>P' + i + '</strong><div style="font-size:11px;color:#6b7280"> $' + (10*i) + '</div></div>';
            seat.appendChild(inner);
            seatsContainer.appendChild(seat);
          }
          // show empty seats (visual) for remaining positions up to 8, ghosted
          for(let j=count+1;j<=8;j++){
            const seat = document.createElement('div');
            seat.className = 'player-seat ' + POS_CLASSES[(j-1) % POS_CLASSES.length] + ' seat grey';
            seat.innerHTML = '<div class="label">Empty</div>';
            seatsContainer.appendChild(seat);
          }
        }

        // initialize with selected value from the newly-populated select
        renderSeats(Math.max(2, Number(select.value || 7)));

        // on change, re-render seats
        select.addEventListener('change', function(e){
          const v = Math.max(2, Number(e.target.value) || 2);
          renderSeats(v);
        });
      })();
    </script>
  </body>
</html>